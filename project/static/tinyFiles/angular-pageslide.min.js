angular.module("pageslide-directive",[]).directive("pageslide",["$document",function(t){return{restrict:"EAC",transclude:!1,scope:{psOpen:"=?",psAutoClose:"=?",psSide:"@",psSpeed:"@",psClass:"@",psSize:"@",psSqueeze:"@",psCloak:"@",psPush:"@",psContainer:"@",psKeyListener:"@",psBodyClass:"@"},link:function(n,e,r){function i(t){if(f.bodyClass){var n=f.className+"-body",e=RegExp(" "+n+"-closed| "+n+"-open");p.className=p.className.replace(e,""),p.className+=" "+n+"-"+t}}function u(t){p.style.top=t.top||p.style.top,p.style.right=t.right||p.style.right,p.style.bottom=t.bottom||p.style.bottom,p.style.left=t.left||p.style.left}function o(t){g.style.top=t.top||g.style.top,g.style.right=t.right||g.style.right,g.style.bottom=t.bottom||g.style.bottom,g.style.left=t.left||g.style.left}function a(t){g.style.width=t.width||g.style.width,g.style.height=t.height||g.style.height}function s(e,r){if(e&&0!==e.style.width)switch(r.cloak&&h.css("display","none"),r.side){case"right":a({width:"0px"}),r.squeeze&&o({right:"0px"}),r.push&&o({right:"0px",left:"0px"});break;case"left":a({width:"0px"}),r.squeeze&&o({left:"0px"}),r.push&&o({right:"0px",left:"0px"});break;case"top":a({height:"0px"}),r.squeeze&&o({top:"0px"}),r.push&&o({top:"0px",bottom:"0px"});break;case"bottom":a({height:"0px"}),r.squeeze&&o({bottom:"0px"}),r.push&&o({top:"0px",bottom:"0px"})}n.psOpen=!1,r.keyListener&&t.off("keydown",c),i("closed")}function l(n,e){if(0!==n.style.width){switch(e.side){case"right":a({width:e.size}),e.squeeze&&u({right:e.size}),e.push&&u({right:e.size,left:"-"+e.size});break;case"left":a({width:e.size}),e.squeeze&&u({left:e.size}),e.push&&u({right:"-"+e.size,left:e.size});break;case"top":a({height:e.size}),e.squeeze&&u({top:e.size}),e.push&&u({top:e.size,bottom:"-"+e.size});break;case"bottom":a({height:e.size}),e.squeeze&&u({bottom:e.size}),e.push&&u({top:"-"+e.size,bottom:e.size})}setTimeout(function(){e.cloak&&h.css("display","block")},1e3*e.speed),e.keyListener&&t.on("keydown",c),i("open")}}function c(t){var n=27,e=t.keyCode||t.which;e===n&&s(g,f)}var f={bodyClass:n.psBodyClass||!1,className:n.psClass||"ng-pageslide",cloak:n.psCloak&&"false"==n.psCloak.toLowerCase()?!1:!0,container:n.psContainer||!1,keyListener:!!n.psKeyListener||!1,push:!!n.psPush||!1,side:n.psSide||"right",size:n.psSize||"300px",speed:n.psSpeed||"0.5",squeeze:!!n.psSqueeze||!1,zIndex:0};e.addClass(f.className);var h=null,g=null,p=f.container&&document.getElementById(f.container)||document.body;if(i("closed"),g=e[0],"div"!==g.tagName.toLowerCase()&&"pageslide"!==g.tagName.toLowerCase())throw Error("Pageslide can only be applied to <div> or <pageslide> elements");if(0===g.children.length)throw Error("You have to content inside the <pageslide>");switch(h=angular.element(g.children),p.appendChild(g),g.style["z-index"]=f.zIndex,g.style.position=f.container!==!1?"absolute":"fixed",g.style.width=0,g.style.height=0,g.style.overflow="hidden",g.style["overflow-y"]="scroll",g.style.transitionDuration=f.speed+"s",g.style.webkitTransitionDuration=f.speed+"s",g.style.transitionProperty="width, height",f.squeeze&&(p.style.position="absolute",p.style.transitionDuration=f.speed+"s",p.style.webkitTransitionDuration=f.speed+"s",p.style.transitionProperty="top, bottom, left, right"),f.side){case"right":a({height:r.psCustomHeight||"100%"}),o({top:r.psCustomTop||"0px",right:r.psCustomRight||"0px",bottom:r.psCustomBottom||"0px"});break;case"left":a({height:r.psCustomHeight||"100%"}),o({top:r.psCustomTop||"0px",bottom:r.psCustomBottom||"0px",left:r.psCustomLeft||"0px"});break;case"top":a({width:r.psCustomWidth||"100%"}),o({top:r.psCustomTop||"0px",right:r.psCustomRight||"0px",left:r.psCustomLeft||"0px"});break;case"bottom":a({width:r.psCustomWidth||"100%"}),o({right:r.psCustomRight||"0px",left:r.psCustomLeft||"0px",bottom:r.psCustomBottom||"0px"})}n.$watch("psOpen",function(t){t?l(g,f):s(g,f)}),n.$watch("psSize",function(t,n){n!==t&&(f.size=t,l(g,f))}),n.$on("$destroy",function(){p.removeChild(g)}),n.psAutoClose&&(n.$on("$locationChangeStart",function(){s(g,f)}),n.$on("$stateChangeStart",function(){s(g,f)}))}}}]);